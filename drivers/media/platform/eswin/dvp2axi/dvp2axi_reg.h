// SPDX-License-Identifier: GPL-2.0
/*
 * ESWIN DVP2AXI dvp2axi_reg driver
 *
 * Copyright 2025, Beijing ESWIN Computing Technology Co., Ltd.. All rights reserved.
 * SPDX-License-Identifier: GPL-2.0
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, version 2.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 *
 * Authors: Eswin VI team
 */

#ifndef __DVP2AXI_HEADER__
#define __DVP2AXI_HEADER__

// #include <u84_metal_ctype.h>

#define VI_DVP2AXI_CTRL0_CSR  0x0
#define VI_DVP2AXI_CTRL0_DVP3_SHIFT_NUM_MASK 0xf0000000
#define VI_DVP2AXI_CTRL0_DVP2_SHIFT_NUM_MASK 0x0f000000
#define VI_DVP2AXI_CTRL0_DVP1_SHIFT_NUM_MASK 0x00f00000
#define VI_DVP2AXI_CTRL0_DVP0_SHIFT_NUM_MASK 0x000f0000
#define VI_DVP2AXI_CTRL0_AXI_SOFT_RSTN_DONE_MASK 0x00004000
#define VI_DVP2AXI_CTRL0_DVP_DATA_SHIFT_MASK 0x00003f00
#define VI_DVP2AXI_CTRL0_AXI_BURST_LEN_MASK 0x00000080
#define VI_DVP2AXI_CTRL0_AXI_SOFT_RSTN_MASK 0x00000040
#define VI_DVP2AXI_CTRL0_DVP_CHN_EN_MASK 0x0000003f

#define VI_DVP2AXI_CTRL1_CSR  0x4
#define VI_DVP2AXI_CTRL1_IO_DVP_MUX_MASK 0xc0000000
#define VI_DVP2AXI_CTRL1_DVP1_PIXEL_WIDTH_MASK 0x3e000000
#define VI_DVP2AXI_CTRL1_DVP0_PIXEL_WIDTH_MASK 0x01f00000
#define VI_DVP2AXI_CTRL1_DVP5_PIXEL_MODE_MASK 0x000c0000
#define VI_DVP2AXI_CTRL1_DVP4_PIXEL_MODE_MASK 0x00030000
#define VI_DVP2AXI_CTRL1_DVP3_PIXEL_MODE_MASK 0x0000c000
#define VI_DVP2AXI_CTRL1_DVP2_PIXEL_MODE_MASK 0x00003000
#define VI_DVP2AXI_CTRL1_DVP1_PIXEL_MODE_MASK 0x00000c00
#define VI_DVP2AXI_CTRL1_DVP0_PIXEL_MODE_MASK 0x00000300
#define VI_DVP2AXI_CTRL1_DVP5_SHIFT_NUM_MASK 0x000000f0
#define VI_DVP2AXI_CTRL1_DVP4_SHIFT_NUM_MASK 0x0000000f


#define VI_DVP2AXI_CTRL2_CSR  0x8
#define VI_DVP2AXI_CTRL2_AXI_OUTSTANDING_MASK 0xff000000
#define VI_DVP2AXI_CTRL2_AXI_MSTR_WQOS_CFG_MASK 0x00f00000
#define VI_DVP2AXI_CTRL2_DVP5_PIXEL_WIDTH_MASK 0x000f8000
#define VI_DVP2AXI_CTRL2_DVP4_PIXEL_WIDTH_MASK 0x00007c00
#define VI_DVP2AXI_CTRL2_DVP3_PIXEL_WIDTH_MASK 0x000003e0
#define VI_DVP2AXI_CTRL2_DVP2_PIXEL_WIDTH_MASK 0x0000001f

/* ctrl3~8: dvp 0~5 size */
#define VI_DVP2AXI_CTRL3_CSR  0xc
#define VI_DVP2AXI_CTRL4_CSR  0x10
#define VI_DVP2AXI_CTRL5_CSR  0x14
#define VI_DVP2AXI_CTRL6_CSR  0x18
#define VI_DVP2AXI_CTRL7_CSR  0x1c
#define VI_DVP2AXI_CTRL8_CSR  0x20
#define VI_DVP2AXI_CTRL_DVP_HS_NUM_MASK  0x0000ffff
#define VI_DVP2AXI_CTRL_DVP_VS_NUM_MASK  0xffff0000

/* crtl9~32: dvp 0~5, virtual channel 0~2 and embedded(3) base address */
#define VI_DVP2AXI_CTRL9_CSR  0x24
#define VI_DVP2AXI_CTRL10_CSR 0x28
#define VI_DVP2AXI_CTRL11_CSR 0x2c
#define VI_DVP2AXI_CTRL12_CSR 0x30
#define VI_DVP2AXI_CTRL13_CSR 0x34
#define VI_DVP2AXI_CTRL14_CSR 0x38
#define VI_DVP2AXI_CTRL15_CSR 0x3c
#define VI_DVP2AXI_CTRL16_CSR 0x40
#define VI_DVP2AXI_CTRL17_CSR 0x44
#define VI_DVP2AXI_CTRL18_CSR 0x48
#define VI_DVP2AXI_CTRL19_CSR 0x4c
#define VI_DVP2AXI_CTRL20_CSR 0x50
#define VI_DVP2AXI_CTRL21_CSR 0x54
#define VI_DVP2AXI_CTRL22_CSR 0x58
#define VI_DVP2AXI_CTRL23_CSR 0x5c
#define VI_DVP2AXI_CTRL24_CSR 0x60
#define VI_DVP2AXI_CTRL25_CSR 0x64
#define VI_DVP2AXI_CTRL26_CSR 0x68
#define VI_DVP2AXI_CTRL27_CSR 0x6c
#define VI_DVP2AXI_CTRL28_CSR 0x70
#define VI_DVP2AXI_CTRL29_CSR 0x74
#define VI_DVP2AXI_CTRL30_CSR 0x78
#define VI_DVP2AXI_CTRL31_CSR 0x7c
#define VI_DVP2AXI_CTRL32_CSR 0x80

/* ctrl33~35: dvp0~5 H stride setting: 16byte aligned per image line */
#define VI_DVP2AXI_CTRL33_CSR 0x84
#define VI_DVP2AXI_CTRL34_CSR 0x88
#define VI_DVP2AXI_CTRL35_CSR 0x8c

/* ctrl36: dvp virtual id enabled */
#define VI_DVP2AXI_CTRL36_CSR 0x90
#define VI_DVP2AXI_DVP0_FIRST_ID_OFFSET 0
#define VI_DVP2AXI_DVP1_FIRST_ID_OFFSET 2
#define VI_DVP2AXI_DVP2_FIRST_ID_OFFSET 4
#define VI_DVP2AXI_DVP3_FIRST_ID_OFFSET 6
#define VI_DVP2AXI_DVP4_FIRST_ID_OFFSET 8
#define VI_DVP2AXI_DVP5_FIRST_ID_OFFSET 10
#define VI_DVP2AXI_DVP0_LAST_ID_OFFSET 18
#define VI_DVP2AXI_DVP1_LAST_ID_OFFSET 20
#define VI_DVP2AXI_DVP2_LAST_ID_OFFSET 22
#define VI_DVP2AXI_DVP3_LAST_ID_OFFSET 24
#define VI_DVP2AXI_DVP5_LAST_ID_OFFSET 26
#define VI_DVP2AXI_DVP6_LAST_ID_OFFSET 28

#define VI_DVP2AXI_INT0_CSR 0xa0
#define VI_DVP2AXI_INT0_DVP2_ID2_FRAME_DONE 0x20000
#define VI_DVP2AXI_INT0_DVP2_ID1_FRAME_DONE 0x10000
#define VI_DVP2AXI_INT0_DVP2_ID0_FRAME_DONE 0x8000
#define VI_DVP2AXI_INT0_DVP1_ID2_FRAME_DONE 0x4000
#define VI_DVP2AXI_INT0_DVP1_ID1_FRAME_DONE 0x2000
#define VI_DVP2AXI_INT0_DVP1_ID0_FRAME_DONE 0x1000
#define VI_DVP2AXI_INT0_DVP0_ID2_FRAME_DONE 0x800
#define VI_DVP2AXI_INT0_DVP0_ID1_FRAME_DONE 0x400
#define VI_DVP2AXI_INT0_DVP0_ID0_FRAME_DONE 0x200
#define VI_DVP2AXI_INT0_DVP2_ID2_FRAME_FLUSH 0x100
#define VI_DVP2AXI_INT0_DVP2_ID1_FRAME_FLUSH 0x80
#define VI_DVP2AXI_INT0_DVP2_ID0_FRAME_FLUSH 0x40
#define VI_DVP2AXI_INT0_DVP1_ID2_FRAME_FLUSH 0x20
#define VI_DVP2AXI_INT0_DVP1_ID1_FRAME_FLUSH 0x10
#define VI_DVP2AXI_INT0_DVP1_ID0_FRAME_FLUSH 0x8
#define VI_DVP2AXI_INT0_DVP0_ID2_FRAME_FLUSH 0x4
#define VI_DVP2AXI_INT0_DVP0_ID1_FRAME_FLUSH 0x2
#define VI_DVP2AXI_INT0_DVP0_ID0_FRAME_FLUSH 0x1


#define VI_DVP2AXI_INT1_CSR 0xa4
#define VI_DVP2AXI_INT0_DVP5_ID2_FRAME_DONE 0x20000
#define VI_DVP2AXI_INT0_DVP5_ID1_FRAME_DONE 0x10000
#define VI_DVP2AXI_INT0_DVP5_ID0_FRAME_DONE 0x8000
#define VI_DVP2AXI_INT0_DVP4_ID2_FRAME_DONE 0x4000
#define VI_DVP2AXI_INT0_DVP4_ID1_FRAME_DONE 0x2000
#define VI_DVP2AXI_INT0_DVP4_ID0_FRAME_DONE 0x1000
#define VI_DVP2AXI_INT0_DVP3_ID2_FRAME_DONE 0x800
#define VI_DVP2AXI_INT0_DVP3_ID1_FRAME_DONE 0x400
#define VI_DVP2AXI_INT0_DVP3_ID0_FRAME_DONE 0x200
#define VI_DVP2AXI_INT0_DVP5_ID2_FRAME_FLUSH 0x100
#define VI_DVP2AXI_INT0_DVP5_ID1_FRAME_FLUSH 0x80
#define VI_DVP2AXI_INT0_DVP5_ID0_FRAME_FLUSH 0x40
#define VI_DVP2AXI_INT0_DVP4_ID2_FRAME_FLUSH 0x20
#define VI_DVP2AXI_INT0_DVP4_ID1_FRAME_FLUSH 0x10
#define VI_DVP2AXI_INT0_DVP4_ID0_FRAME_FLUSH 0x8
#define VI_DVP2AXI_INT0_DVP3_ID2_FRAME_FLUSH 0x4
#define VI_DVP2AXI_INT0_DVP3_ID1_FRAME_FLUSH 0x2
#define VI_DVP2AXI_INT0_DVP3_ID0_FRAME_FLUSH 0x1

#define VI_DVP2AXI_INT2_CSR 0xa8
#define VI_DVP2AXI_INT2_AXI_IDBUFFER_AFULL  0x100
#define VI_DVP2AXI_INT2_DVP5_FRAME_ERROR    0x80
#define VI_DVP2AXI_INT2_DVP4_FRAME_ERROR    0x40
#define VI_DVP2AXI_INT2_DVP3_FRAME_ERROR    0x20
#define VI_DVP2AXI_INT2_DVP2_FRAME_ERROR    0x10
#define VI_DVP2AXI_INT2_DVP1_FRAME_ERROR    0x8
#define VI_DVP2AXI_INT2_DVP0_FRAME_ERROR    0x4
#define VI_DVP2AXI_INT2_AXI_RESP_ERROR      0x2
#define VI_DVP2AXI_INT2_AXI_IDBUFFER_FULL   0x1

#define DVP_PIXEL_MODE_RAW 0x0
#define DVP_PIXEL_MODE_YUV 0x1
#define DVP_PIXEL_MODE_RGB 0x2

//little-endian
typedef union dvp2axi_ctrl36_csr_s {
    struct {
        uint32_t dvp0_first_id:2;
        uint32_t dvp1_first_id:2;
        uint32_t dvp2_first_id:2;
        uint32_t dvp3_first_id:2;
        uint32_t dvp4_first_id:2;
        uint32_t dvp5_first_id:2;
        uint32_t dvp_embed_con_en:6;
        uint32_t dvp0_last_id:2;
        uint32_t dvp1_last_id:2;
        uint32_t dvp2_last_id:2;
        uint32_t dvp3_last_id:2;
        uint32_t dvp4_last_id:2;
        uint32_t dvp5_last_id:2;
        uint32_t reserved:2;
    } bf;
    uint32_t dw;
} dvp2axi_ctrl36_csr_t;

#define VI_DVP2AXI_INT0_CSR 0xa0
#define VI_DVP2AXI_DVP0_ID0_FRAME_FLUSH_MASK (1 << 0)
#define VI_DVP2AXI_DVP0_ID1_FRAME_FLUSH_MASK (1 << 1)
#define VI_DVP2AXI_DVP0_ID2_FRAME_FLUSH_MASK (1 << 2)
#define VI_DVP2AXI_DVP1_ID0_FRAME_FLUSH_MASK (1 << 3)
#define VI_DVP2AXI_DVP1_ID1_FRAME_FLUSH_MASK (1 << 4)
#define VI_DVP2AXI_DVP1_ID2_FRAME_FLUSH_MASK (1 << 5)
#define VI_DVP2AXI_DVP2_ID0_FRAME_FLUSH_MASK (1 << 6)
#define VI_DVP2AXI_DVP2_ID1_FRAME_FLUSH_MASK (1 << 7)
#define VI_DVP2AXI_DVP2_ID2_FRAME_FLUSH_MASK (1 << 8)
#define VI_DVP2AXI_DVP0_ID0_FRAME_DONE_MASK  (1 << 9)
#define VI_DVP2AXI_DVP0_ID1_FRAME_DONE_MASK  (1 << 10)
#define VI_DVP2AXI_DVP0_ID2_FRAME_DONE_MASK  (1 << 11)
#define VI_DVP2AXI_DVP1_ID0_FRAME_DONE_MASK  (1 << 12)
#define VI_DVP2AXI_DVP1_ID1_FRAME_DONE_MASK  (1 << 13)
#define VI_DVP2AXI_DVP1_ID2_FRAME_DONE_MASK  (1 << 14)
#define VI_DVP2AXI_DVP2_ID0_FRAME_DONE_MASK  (1 << 15)
#define VI_DVP2AXI_DVP2_ID1_FRAME_DONE_MASK  (1 << 16)
#define VI_DVP2AXI_DVP2_ID2_FRAME_DONE_MASK  (1 << 17)

#define VI_DVP2AXI_INT1_CSR 0xa4
#define VI_DVP2AXI_DVP3_ID0_FRAME_FLUSH_MASK (1 << 0)
#define VI_DVP2AXI_DVP3_ID1_FRAME_FLUSH_MASK (1 << 1)
#define VI_DVP2AXI_DVP3_ID2_FRAME_FLUSH_MASK (1 << 2)
#define VI_DVP2AXI_DVP4_ID0_FRAME_FLUSH_MASK (1 << 3)
#define VI_DVP2AXI_DVP4_ID1_FRAME_FLUSH_MASK (1 << 4)
#define VI_DVP2AXI_DVP4_ID2_FRAME_FLUSH_MASK (1 << 5)
#define VI_DVP2AXI_DVP5_ID0_FRAME_FLUSH_MASK (1 << 6)
#define VI_DVP2AXI_DVP5_ID1_FRAME_FLUSH_MASK (1 << 7)
#define VI_DVP2AXI_DVP5_ID2_FRAME_FLUSH_MASK (1 << 8)
#define VI_DVP2AXI_DVP3_ID0_FRAME_DONE_MASK  (1 << 9)
#define VI_DVP2AXI_DVP3_ID1_FRAME_DONE_MASK  (1 << 10)
#define VI_DVP2AXI_DVP3_ID2_FRAME_DONE_MASK  (1 << 11)
#define VI_DVP2AXI_DVP4_ID0_FRAME_DONE_MASK  (1 << 12)
#define VI_DVP2AXI_DVP4_ID1_FRAME_DONE_MASK  (1 << 13)
#define VI_DVP2AXI_DVP4_ID2_FRAME_DONE_MASK  (1 << 14)
#define VI_DVP2AXI_DVP5_ID0_FRAME_DONE_MASK  (1 << 15)
#define VI_DVP2AXI_DVP5_ID1_FRAME_DONE_MASK  (1 << 16)
#define VI_DVP2AXI_DVP5_ID2_FRAME_DONE_MASK  (1 << 17)

#define VI_DVP2AXI_INT2_CSR 0xa8
#define VI_DVP2AXI_AXI_IDBUFFER_FULL_MASK  (1 << 0)
#define VI_DVP2AXI_AXI_RESP_ERROR_MASK     (1 << 1)
#define VI_DVP2AXI_DVP0_FRAME_ERROR_MASK   (1 << 2)
#define VI_DVP2AXI_DVP1_FRAME_ERROR_MASK   (1 << 3)
#define VI_DVP2AXI_DVP2_FRAME_ERROR_MASK   (1 << 4)
#define VI_DVP2AXI_DVP3_FRAME_ERROR_MASK   (1 << 5)
#define VI_DVP2AXI_DVP4_FRAME_ERROR_MASK   (1 << 6)
#define VI_DVP2AXI_DVP5_FRAME_ERROR_MASK   (1 << 7)
#define VI_DVP2AXI_AXI_DIBUFFER_AFULL_MASK (1 << 8)

#define VI_DVP2AXI_INT_MASK0_CSR 0xac
#define VI_DVP2AXI_INT_MASK1_CSR 0xb0
#define VI_DVP2AXI_INT_MASK2_CSR 0xb4

/* embedded channel setting */
#define VI_DVP2AXI_CTRL37 0x94
#define VI_DVP2AXI_CTRL38 0x98
#define VI_DVP2AXI_CTRL39 0x9c
#define VI_DVP2AXI_CTRL40 0xe0
#define VI_DVP2AXI_CTRL41 0xe4
#define VI_DVP2AXI_CTRL42 0xe8
#define VI_DVP2AXI_CTRL43 0xec


#define VI_DVP2AXI_DVP_CHANNELS     6
#define VI_DVP2AXI_VIRTUAL_CHANNELS 4
#define VI_DVP2AXI_CAP_FRAME_NUMBER 0

/* interrupt */
// #define VI_DVP2AXI_IRQ_ENABLE
#define VI_DVP2AXI_IRQ_PRIORITY  0

// void bmtest_dvp2axi_soft_reset(void);
// void bmtest_dvp2axi_hw_program(void);
// void bmtest_dvp2axi_hw_int_setup(void);
// void bmtest_dvp2axi_hw_enable(void);
// void bmtest_dvp2axi_hw_wait(void);
// void bmtest_dvp2axi_hw_dump_regs(void);
// void bmtest_dvp2axi_hw_notify(int result);

// void bmtest_dvp2axi_buffer_clear(void);
// int bmtest_dvp2axi_buffer_check(void);

#endif
