KERNEL :=/lib/modules/$(shell uname -r)/build
ISP_VERSION := ISP8000_V2107
VI200_VERSION := NONE
DW_VERSION := DW200_V40
MIPI_VERSION := NWL
INSTALL_DIR:= $(VVCAM_PATH)/install/$(ISP_VERSION)

ifeq ($(VI200_VERSION), NONE)
PCIE_BASE ?= 0xDE000000
else
PCIE_BASE ?= 0xDD000000
endif

ifeq ($(ISP_VERSION), ISP8000_V2107)
include $(VVCAM_PATH)/isp_version/ISP8000_V2107.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2201)
include $(VVCAM_PATH)/isp_version/ISP8000_V2201.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2202)
include $(VVCAM_PATH)/isp_version/ISP8000_V2202.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2203)
include $(VVCAM_PATH)/isp_version/ISP8000_V2203.mk
endif

ifeq ($(ISP_VERSION), ISP8200_V2204)
include $(VVCAM_PATH)/isp_version/ISP8200_V2204.mk
endif

ifeq ($(ISP_VERSION), ISP8200L_V2304)
include $(VVCAM_PATH)/isp_version/ISP8200L_V2304.mk
endif

ifeq ($(ISP_VERSION), ISP8200LC_V2403)
include $(VVCAM_PATH)/isp_version/ISP8200LC_V2403.mk
endif

ifeq ($(ISP_VERSION), ISP8200LCR_V2403)
include $(VVCAM_PATH)/isp_version/ISP8200LCR_V2403.mk
endif

ifeq ($(ISP_VERSION), ISP8210L_V2302)
include $(VVCAM_PATH)/isp_version/ISP8210L_V2302.mk
endif

ifeq ($(ISP_VERSION), ISP8000L_V2305)
include $(VVCAM_PATH)/isp_version/ISP8000L_V2305.mk
endif

ifeq ($(ISP_VERSION), ISP8000L_V2306)
include $(VVCAM_PATH)/isp_version/ISP8000L_V2306.mk
endif

ifeq ($(ISP_VERSION), ISP8000L_V2310)
include $(VVCAM_PATH)/isp_version/ISP8000L_V2310.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2011)
include $(VVCAM_PATH)/isp_version/ISP8000_V2011.mk
endif

ifeq ($(ISP_VERSION), ISP8000L_V2002)
include $(VVCAM_PATH)/isp_version/ISP8000L_V2002.mk
endif

ifeq ($(ISP_VERSION), ISP8000L_V2103)
include $(VVCAM_PATH)/isp_version/ISP8000L_V2103.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2104)
include $(VVCAM_PATH)/isp_version/ISP8000_V2104.mk
endif

ifeq ($(ISP_VERSION), ISP8200_V2303)
include $(VVCAM_PATH)/isp_version/ISP8200_V2303.mk
endif

ifeq ($(ISP_VERSION), ISP8200_V2307)
include $(VVCAM_PATH)/isp_version/ISP8200_V2307.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2308)
include $(VVCAM_PATH)/isp_version/ISP8000_V2308.mk
endif

ifeq ($(ISP_VERSION), ISP8200_V2311)
include $(VVCAM_PATH)/isp_version/ISP8200_V2311.mk
endif

ifeq ($(ISP_VERSION), ISP8210L_V2302)
include $(VVCAM_PATH)/isp_version/ISP8210L_V2302.mk
endif

ifeq ($(ISP_VERSION), ISP8200NANO_V2401)
include $(VVCAM_PATH)/isp_version/ISP8200NANO_V2401.mk
endif

ifeq ($(ISP_VERSION), ISP8200L_V2404)
include $(VVCAM_PATH)/isp_version/ISP8200L_V2404.mk
endif

ifeq ($(ISP_VERSION), ISP8000_V2405)
include $(VVCAM_PATH)/isp_version/ISP8000_V2405.mk
endif

ifeq ($(ISP_VERSION), ISP8200_V2406)
include $(VVCAM_PATH)/isp_version/ISP8200_V2406.mk
endif

ifeq ($(ISP_VERSION), ISP8000L_V2407)
include $(VVCAM_PATH)/isp_version/ISP8000L_V2407.mk
endif

# Vi200 version
ifeq ($(VI200_VERSION), VI200_V1)
include $(VVCAM_PATH)/vi200_version/VI200_V1.mk
else ifeq ($(VI200_VERSION), VI200_V2)
include $(VVCAM_PATH)/vi200_version/VI200_V2.mk
else ifeq ($(VI200_VERSION), VI200_V21)
include $(VVCAM_PATH)/vi200_version/VI200_V21.mk
else ifeq ($(VI200_VERSION), VI200_V22)
include $(VVCAM_PATH)/vi200_version/VI200_V22.mk
endif

EXTRA_CFLAGS += -DM2_REGISTER_MAP

EXTRA_CFLAGS += -DSCU_BASE=0x51828000
EXTRA_CFLAGS += -DSCU_SIZE=0x00008000

EXTRA_CFLAGS += -DPCIE_BASE=$(PCIE_BASE)

# EXTRA_CFLAGS += -DVVCAM_I2C_SIZE=0x4
# EXTRA_CFLAGS += -DVVCAM_I2C_BUS0=8
# EXTRA_CFLAGS += -DVVCAM_I2C_BUS1=9
# EXTRA_CFLAGS += -DVVCAM_I2C_BUS2=10
# EXTRA_CFLAGS += -DVVCAM_I2C_BUS3=11

ifeq ($(VI200_VERSION), NONE)
EXTRA_CFLAGS += -DVVCAM_TPG0=0x00308300
EXTRA_CFLAGS += -DVVCAM_TPG1=0x00308310
EXTRA_CFLAGS += -DVVCAM_TPG2=0x00308320

# EXTRA_CFLAGS += -DVVCAM_I2C0_BASE=0x003080f0
# EXTRA_CFLAGS += -DVVCAM_I2C1_BASE=0x003080f4
# EXTRA_CFLAGS += -DVVCAM_I2C2_BASE=0x003080f8
# EXTRA_CFLAGS += -DVVCAM_I2C3_BASE=0x003080fc

# EXTRA_CFLAGS += -DVVCAM_CSI0_BASE=0x00200000
# EXTRA_CFLAGS += -DVVCAM_CSI1_BASE=0x00300000
# EXTRA_CFLAGS += -DVVCAM_CSI2_BASE=0x00204000
# EXTRA_CFLAGS += -DVVCAM_CSI3_BASE=0x00304000
# EXTRA_CFLAGS += -DVVCAM_CSI_REG_SIZE=0x4000

# EXTRA_CFLAGS += -DVVCAM_CSI0_CTRL=0x00308240
# EXTRA_CFLAGS += -DVVCAM_CSI1_CTRL=0x00308244
# EXTRA_CFLAGS += -DVVCAM_CSI2_CTRL=0x00308248
# EXTRA_CFLAGS += -DVVCAM_CSI3_CTRL=0x0030824C
# EXTRA_CFLAGS += -DVVCAM_CSI_CTRL_SIZE=0x4

# EXTRA_CFLAGS += -DVVCAM_CSI0_MUX_CTRL=0x00208304
# EXTRA_CFLAGS += -DVVCAM_CSI1_MUX_CTRL=0x00308304
# EXTRA_CFLAGS += -DVVCAM_CSI2_MUX_CTRL=0x0020C304
# EXTRA_CFLAGS += -DVVCAM_CSI3_MUX_CTRL=0x0030C304
# EXTRA_CFLAGS += -DVVCAM_CSI_MUX_CTRL_SIZE=0x4

EXTRA_CFLAGS += -DVVCAM_ISP_CTRL=0x00308270
EXTRA_CFLAGS += -DVVCAM_ISP_CTRL_SIZE=0x4
endif

# ifeq ($(ISP_VERSION), ISP8000L_V2103)
# EXTRA_CFLAGS += -DINPUT_CSI_MUX_8000L
# endif

EXTRA_CFLAGS += -DVVCAM_TPG3=0x00308330
EXTRA_CFLAGS += -DVVCAM_TPG_SIZE=0x4

ifeq ($(ISP_VERSION), ISP8000NANO_V2012)
EXTRA_CFLAGS += -DVVCAM_CSI_BUS_WIDTH=12
else
EXTRA_CFLAGS += -DVVCAM_CSI_BUS_WIDTH=16
endif

ifeq ($(ISP_VERSION), $(findstring $(ISP_VERSION), ISP8000_V2107 ISP8000_V2108 ISP8000_V2202 ISP8000_V2203 ISP8200L_V2304 ISP8210L_V2302 ISP8000L_V2305 ISP8200_V2303 ISP8000_V2308 ISP8200_V2311 ISP8000L_V2310 ISP8000L_V2002 ISP8000NANO_V2302))

EXTRA_CFLAGS += -DCSI_CTRL_MUX_T0T1=1
EXTRA_CFLAGS += -DCSI_CTRL_MUX_T2T3=0
else
EXTRA_CFLAGS += -DCSI_CTRL_MUX_T0T1=1
EXTRA_CFLAGS += -DCSI_CTRL_MUX_T2T3=0
endif


ifeq ($(ISP_VERSION), $(findstring $(ISP_VERSION), ISP8000_V2405 ISP8000_V2408 ISP8200_V2204 ISP8200_V2303 ISP8200_V2307 ISP8200_V2311 ISP8200_V2406 ISP8200L_V2304 ISP8200L_V2404 ISP8200LC_V2403 ISP8200LCR_V2403 ISP8210L_V2302))

EXTRA_CFLAGS += -DAHB_WR_WITH_FE=1
else
EXTRA_CFLAGS += -DAHB_WR_WITH_FE=0
endif

ifeq ($(VI200_VERSION), NONE)

ifeq ($(ISP_VERSION), ISP8000_V2009)
EXTRA_CFLAGS += -DVVCAM_ISP0_BASE=0x00600000
EXTRA_CFLAGS += -DVVCAM_ISP1_BASE=0x00700000
EXTRA_CFLAGS += -DVVCAM_ISP2_BASE=0x00FFFFFF
else
EXTRA_CFLAGS += -DVVCAM_ISP0_BASE=0x00000000
EXTRA_CFLAGS += -DVVCAM_ISP1_BASE=0x00100000
EXTRA_CFLAGS += -DVVCAM_ISP2_BASE=0x00FFFFFF
endif

endif

EXTRA_CFLAGS += -DVVCAM_ISP_REG_SIZE=0x10000

EXTRA_CFLAGS += -DVVCAM_ISP0_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP0_MI_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP0_FE_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP0_FUSA_IRQ=16

EXTRA_CFLAGS += -DVVCAM_ISP1_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP1_MI_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP1_FE_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP1_FUSA_IRQ=16

EXTRA_CFLAGS += -DVVCAM_ISP2_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP2_MI_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP2_FE_IRQ=16
EXTRA_CFLAGS += -DVVCAM_ISP2_FUSA_IRQ=16

EXTRA_CFLAGS += -DVVCAM_RMEM_BASE=0x10000000
EXTRA_CFLAGS += -DVVCAM_RMEM_SIZE=0x20000000

ifdef MSS
EXTRA_CFLAGS += -DVVCAM_MSS_RESET_BASE=0x00308260
EXTRA_CFLAGS += -DVVCAM_MSS_RESET_SIZE=0x4
EXTRA_CFLAGS += -DVVCAM_MSS_BASE=0x00500000
EXTRA_CFLAGS += -DVVCAM_MSS_REG_SIZE=0x10000
endif

ifeq ($(DW_VERSION), $(findstring $(DW_VERSION), DW200_V40 DW200_V41))
EXTRA_CFLAGS += -DVVCAM_DWE_REG_BASE=0xDE381C00
EXTRA_CFLAGS += -DVVCAM_DWE_REG_SIZE=0x00000800
EXTRA_CFLAGS += -DVVCAM_VSE_REG_BASE=0xDE380000
EXTRA_CFLAGS += -DVVCAM_VSE_REG_SIZE=0x00001C00
endif

ifeq ($(DW_VERSION), DW200_V42)
EXTRA_CFLAGS += -DDW200_V42
EXTRA_CFLAGS += -DVVCAM_DWE_REG_BASE=0xDE382C00
EXTRA_CFLAGS += -DVVCAM_DWE_REG_SIZE=0x00000800
EXTRA_CFLAGS += -DVVCAM_VSE_REG_BASE=0xDE380000
EXTRA_CFLAGS += -DVVCAM_VSE_REG_SIZE=0x00002C00
endif

ifeq ($(DW_VERSION), DW200_V30)
EXTRA_CFLAGS += -DVVCAM_DWE_REG_BASE=0xDE380C00
EXTRA_CFLAGS += -DVVCAM_DWE_REG_SIZE=0x00000800
EXTRA_CFLAGS += -DVVCAM_VSE_REG_BASE=0xDE380000
EXTRA_CFLAGS += -DVVCAM_VSE_REG_SIZE=0x00000C00
endif

EXTRA_CFLAGS += -DVVCAM_DW_RST_REG_BASE=0xDE308250
EXTRA_CFLAGS += -DVVCAM_DW_RST_REG_SIZE=0x4

EXTRA_CFLAGS += -DVVCAM_DWE_IRQ=16
EXTRA_CFLAGS += -DVVCAM_VSE_IRQ=16
EXTRA_CFLAGS += -DVVCAM_DW_FE_IRQ=16

# EXTRA_CFLAGS += -O2 -Werror

PLATFORM_DEVICE := 0

ifeq ($(PLATFORM_DEVICE), 1)
EXTRA_CFLAGS += -DVVCAM_PLATFORM_REGISTER
endif

ifeq ($(ISP_VERSION), ISP8000NANO_V2302)
EXTRA_CFLAGS += -DISP8000NANO_V2302
endif

EXTRA_CFLAGS += -DVVCAM_ISP_DEV_MAX=2
